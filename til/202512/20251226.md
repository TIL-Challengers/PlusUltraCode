# 네트워크 나만의 지식을 정리하기

### L2 링크 계층
l2 계층이 뭔데?? 이거는 링크 계층 다른말로 localhost에서 서로 통신하기 위한 프레임 단위 계층이다.
해당 프레임에는 MAC 출발주소, 목적지주소, CRC 그리고 상위 계층을 담고 있는 TYPE이나 PAYLOAD가 있다. 

- MAC 주소란?? 실제 노트북이나 컴퓨터에 고유하게 부착된 물리 주소이다. 회사 + 특수 형태로 고유한 형태로 저장한다. 이거로 출발지나 목적지를 정할 수 있다.
- CRC가 뭔데?? CRC는 오류를 검출하기 위해 사용된다. 오류 해결 아니라 단순히 오류 검출 목적이다.

L2에서 뭐를 통해 출발지와 목적지가 소통해?? 바로 **스위치**

- 스위치란? 포트 기반으로 목적지와 출발지를 연결해주는 장치다. 스위치는 새로운 MAC 주소가 들어오면 학습을 해야 한다.
학습하는 방법은 아래와 같다.
1. 새로운 프레임이 들어오면 출발지 MAC주소에 해당하는 포트 정보를 학습한다. 그러면 목적지 MAC주소에 대한 포트정보는 학습 하지 않느냐?? **정답이다**
왜냐하면 목적지 MAC주소에 해당하는 포트정보는 정확하지 않다. 다만 출발지는 확실하다.

3계층에서 2계층으로 이동할 때 IP에서 MAC주소로 통신할 때 필요한 통신 보조 프로토콜이 존재한다 바로 **ARP 프로토콜이다**
- ARP란? 출발지 IP와 MAC 주소를 기반으로 목적지 IP에 해당하는 MAC주소를 찾게 해주는 프로토콜이다.
ARP가 있어야 목적지 IP에 해당하는 목적지 MAC주소를 찾은 뒤 localhost 내부에서 스위치 기반으로 통신이 가능해진다.

그렇다면 어떻게 알수 있을까?? 바로 브로드캐스트
로컬 영역 혹은 브로드캐스트 도메인 영역 즉 VLAN영역에 브로드캐스트를 진행하여 관련된 정보가 있으면 UNICAST형식으로 반환받는 형태로 알고리즘이 작동한다.

근데 재미난게 매번 매핑결과를 알기 위해서 브로드캐스트 하면 cpu 자원 트래픽이 너무 많아지지 않을까?? 바로 성능최적화하기 위해 
**ARP 캐시** 가 존재한다.

TTL, 유한한 크기 운영체제 레벨에서 관리된다고 한다. 
그러나 캐시가 존재하는 만큼 장애 요소가 증가한다.

ARP범위는 항상 브로드케스트 도메인 다른말로 VLAN 혹은 LOCALHOST내부인데 만약 목적지 IP주소 안에 다른 서브넷들이 여러개 존재한다. 
그럼 다른 서브넷으로 이동하려면 어떻게 해야 하나??? 
ARP를 통해 API GATEWAY의 MAC주소를 알게 해야 한다. 

#### 스위치와 브리지 허브 차이가 뭐야? 
허브 부터 보자면 허브는 L1계층에 존재하면 포트 충돌이 발생한다. HALF - DUPLEX 기반이다. 이러한 문제를 해결하기 위해 생긴게 
브리지 개념 -> 브리지는
포워딩 , 학습 , UNKNOW FLOODING UNICAST, BRAOD CAST, STP를 이용한 루프방지문제 해결 ,기능이 있다. 
이러한 브리지를 고속으로 만든게 스위치다. 
즉 스위치가 최종 형태. 스위치는 다중 포트를 사용하여 포트 충돌 문제를 완화했다. FULL - DUPLEX 원칙

학습은 보통 소스 MAC 주소를 기반으로 학습하고 만약 MAC ADDRESS 테이블에 목적지 MAC 매핑이 없다면 UNKNOW FLOODING UNICAST를 == ARP 를 통해
목적지 MAC 주소를 알아온다. 그 후 매핑 테이블에 저장한 뒤 통신을 주고 받는다.

L2 에서는 루프 제한 장치가 없어서 STP 가필요하다 스패닝 트리 == 단일선으로 이루어진 트리를 의미한다.

스위치와/브리지는 충돌 도메인을 분리해서 FULL-DUPLEX를 이용하고 브로드캐스트 도메인에서 분리하려면 VLAN을 이용해야한다.

- VLAN은 뭘까? 물리적으로 스위치는 같지만 논리적으로 구역을 구분해 놓은 것이다.
브로드캐스트 도메인 == VLAN 을 의미하며 VLAN이 필요한 이유는 아래와 같다.
1. 포트가 늘어날 수록 브로드캐스트가 많아져 CPU및 트래픽이 많아지는데 논리적으로 구분을 해놓으면 VLAN끼리만 브로드캐스트를 진행하게 된다.
2. 또한 보안에서 중요핟.

그렇다면 ACCESS PORT 와 TRUNK PORT의 차이는 뭘까 ?? 
ACCESS PORT는 단말기와 연결된 포트다. VLAN에서 고유한 포트 태그 없음

TRUNK PORT는 뭘까?? -> 이거는 VLAN끼리 네트워크끼리 연결을 도와주는 포트다. 태그 있음 

VLAN끼리 통신은 반드시 L3가 필욯다ㅏ.


- 충돌 도메인과 브로드케스트 도메인 이거에 대해서 이야기 해보자
hub는 충돌 도메인이 무조건 발생 , 브로드캐스트 도메인은 전체다 왜 예내들은 하나가 전기신호가 전달하면 다른 연결된 포트들 모두 전달하기 때문에

switch (vlan 없는경우) 충돌 도메인은 거의 사실상 없다. 브로드캐스트는 전체 
switch (vlan 있는경우) 충돌 도메인은 거의 없다. 브로드캐스트는 가 ㄱvlan 영

라우터는 브로드캐스트르 전달하지 않는다.

- MTU가 뭐야? => L2에서 프레임 단위의 최대 크기. 만약 IP계층에서 데이터 크기가 더 클경우 L2입장에서는 나눠서 보내야 한다. 이걸 FRAGMENTATION이라한다.
- FCS, CRC 가뭐야 ? =>? FCS 는 오류 검증을 위한 결과값이고 CRC는 이런 결과값을 토대로 알고리즘을 적용하여 오류 판별하는 방식이다.

### L3 
- IPV4 가뭘까? -> 네트워크 ID + 호스트 ID 로 구성되어 있다. 네트워크 ID 는 L3들이 서로 통신하기 위한 정보들의 집합이고 호스트 ID 는 L2들이 통신하기 위한 집합이다.
IPV4는 비트수의 한계 대문에 부족증세가 있다. 이로인헤 NAT 프로토콜이 생기게 되었고 IPV6또하 생기게 되엇따.

IPV6 는 IPV4의 갯수의 한계 때문에 생겨났다 128비트이고 서로 호환되도록 터널링 기능을 제공한다. 
기본적으로 CLFASSFUL 은 제공하지 않고 FREFIX법칙 CIDR 과 서브네팅을 제공한다.

- CIDR 과 서브네팅이 뭐야? 
CIDR 은 PREFIX법칙으로 네트워크의 범위를 표현한 방식 0.0.0.0.
